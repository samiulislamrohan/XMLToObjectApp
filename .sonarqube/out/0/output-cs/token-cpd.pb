¼
4D:\Learning\XMLToObjectApp\XMLToObjectApp\Program.cs
	namespace 	
XMLToObjectApp
 
{ 
internal 
static 
class 
Program !
{ 
[ 	
	STAThread	 
] 
static		 
void		 
Main		 
(		 
)		 
{

 	$
ApplicationConfiguration $
.$ %

Initialize% /
(/ 0
)0 1
;1 2
Application 
. 
Run 
( 
new 
Form1  %
(% &
)& '
)' (
;( )
} 	
} 
} î/
7D:\Learning\XMLToObjectApp\XMLToObjectApp\Model\Data.cs
	namespace 	
XMLToObjectApp
 
. 
Model 
{		 
[

 
XmlRoot

 
(

 
$str

 
)

 
]

 
public 

class 
ItemInfo 
{ 
[ 	

XmlElement	 
( 
$str 
) 
]  
public 
Document 
document  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	

XmlElement	 
( 
$str 
) 
] 
public 
Item 
item 
; 
[ 	
XmlArray	 
( 
$str 
) 
] 
[ 	
XmlArrayItem	 
( 
$str 
)  
]  !
public 
List 
< 
Project 
> 
projects %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
} 
public 

class 
Document 
{ 
[ 	
XmlAttribute	 
( 
$str 
) 
] 
public 
string 
id 
{ 
get 
; 
set  #
;# $
}% &
[ 	
XmlAttribute	 
( 
$str 
) 
] 
public   
string   
name   
{   
get    
;    !
set  " %
;  % &
}  ' (
["" 	
XmlAttribute""	 
("" 
$str""  
)""  !
]""! "
public## 
string## 
revision## 
{##  
get##! $
;##$ %
set##& )
;##) *
}##+ ,
[%% 	
XmlAttribute%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 
string&& 
type&& 
{&& 
get&&  
;&&  !
set&&" %
;&&% &
}&&' (
[(( 	
XmlArray((	 
((( 
$str(( 
)(( 
]((  
[)) 	
XmlArrayItem))	 
()) 
$str))  
)))  !
]))! "
public** 
List** 
<** 
Property** 
>** 

properties** (
{**) *
get**+ .
;**. /
set**0 3
;**3 4
}**5 6
}++ 
public,, 

class,, 
Item,, 
{-- 
[.. 	
XmlAttribute..	 
(.. 
$str.. 
).. 
].. 
public// 
string// 
id// 
{// 
get// 
;// 
set//  #
;//# $
}//% &
[11 	
XmlAttribute11	 
(11 
$str11 
)11 
]11 
public22 
string22 
name22 
{22 
get22  
;22  !
set22" %
;22% &
}22' (
[44 	
XmlAttribute44	 
(44 
$str44  
)44  !
]44! "
public55 
string55 
revision55 
{55  
get55! $
;55$ %
set55& )
;55) *
}55+ ,
[77 	
XmlAttribute77	 
(77 
$str77 
)77 
]77 
public88 
string88 
type88 
{88 
get88  
;88  !
set88" %
;88% &
}88' (
[:: 	
XmlAttribute::	 
(:: 
$str:: 
)::  
]::  !
public;; 
string;; 
type3DX;; 
{;; 
get;;  #
;;;# $
set;;% (
;;;( )
};;* +
[== 	
XmlArray==	 
(== 
$str== 
)== 
]==  
[>> 	
XmlArrayItem>>	 
(>> 
$str>>  
)>>  !
]>>! "
public?? 
List?? 
<?? 
Property?? 
>?? 

properties?? (
{??) *
get??+ .
;??. /
set??0 3
;??3 4
}??5 6
}@@ 
publicAA 

classAA 
ProjectAA 
{BB 
[CC 	
XmlAttributeCC	 
(CC 
$strCC 
)CC 
]CC 
publicDD 
stringDD 
idDD 
{DD 
getDD 
;DD 
setDD  #
;DD# $
}DD% &
[FF 	
XmlAttributeFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
stringGG 
nameGG 
{GG 
getGG  
;GG  !
setGG" %
;GG% &
}GG' (
[II 	
XmlArrayII	 
(II 
$strII 
)II 
]II  
[JJ 	
XmlArrayItemJJ	 
(JJ 
$strJJ  
)JJ  !
]JJ! "
publicKK 
ListKK 
<KK 
PropertyKK 
>KK 

propertiesKK (
{KK) *
getKK+ .
;KK. /
setKK0 3
;KK3 4
}KK5 6
}LL 
publicNN 

classNN 
PropertyNN 
{OO 
[PP 	
XmlAttributePP	 
(PP 
$strPP 
)PP 
]PP 
publicQQ 
stringQQ 
keyQQ 
{QQ 
getQQ 
;QQ  
setQQ! $
;QQ$ %
}QQ& '
[SS 	
XmlAttributeSS	 
(SS 
$strSS 
)SS 
]SS 
publicTT 
stringTT 
valueTT 
{TT 
getTT !
;TT! "
setTT# &
;TT& '
}TT( )
}VV 
}WW ®T
2D:\Learning\XMLToObjectApp\XMLToObjectApp\Form1.cs
	namespace 	
XMLToObjectApp
 
{ 
public 

partial 
class 
Form1 
:  
Form! %
{ 
ItemInfo		 
itemInfo		 
;		 
public

 
Form1

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
button2 
. 
Enabled 
= 
false #
;# $
button3 
. 
Enabled 
= 
false #
;# $
} 	
private 
void 
button1_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
string 
filePath 
; 
OpenFileDialog 
openFileDialog )
=* +
new, /
OpenFileDialog0 >
(> ?
)? @
;@ A
if 
( 
openFileDialog 
. 

ShowDialog )
() *
)* +
==, .
DialogResult/ ;
.; <
OK< >
)> ?
{ 
filePath 
= 
openFileDialog )
.) *
FileName* 2
;2 3
XmlSerializer 

serializer (
=) *
new+ .
XmlSerializer/ <
(< =
typeof= C
(C D
ItemInfoD L
)L M
)M N
;N O
using 
( 

FileStream !
stream" (
=) *
new+ .

FileStream/ 9
(9 :
filePath: B
,B C
FileModeD L
.L M
OpenM Q
)Q R
)R S
{ 
itemInfo 
= 
(  
ItemInfo  (
)( )

serializer) 3
.3 4
Deserialize4 ?
(? @
stream@ F
)F G
;G H
string 
textData #
=$ %
$str& 1
+2 3
Environment4 ?
.? @
NewLine@ G
+H I
EnvironmentJ U
.U V
NewLineV ]
;] ^
textData 
= 
textData '
+( )
itemInfo* 2
.2 3
document3 ;
.; <
id< >
+? @
EnvironmentA L
.L M
NewLineM T
;T U
textData 
= 
textData '
+( )
itemInfo* 2
.2 3
document3 ;
.; <
name< @
+A B
EnvironmentC N
.N O
NewLineO V
;V W
textData   
=   
textData   '
+  ( )
itemInfo  * 2
.  2 3
document  3 ;
.  ; <
revision  < D
+  E F
Environment  G R
.  R S
NewLine  S Z
;  Z [
textData!! 
=!! 
textData!! '
+!!( )
itemInfo!!* 2
.!!2 3
document!!3 ;
.!!; <
type!!< @
+!!A B
Environment!!C N
.!!N O
NewLine!!O V
;!!V W
foreach"" 
("" 
var""  
property""! )
in""* ,
itemInfo""- 5
.""5 6
document""6 >
.""> ?

properties""? I
)""I J
{## 
textData$$  
=$$! "
textData$$# +
+$$, -
property$$. 6
.$$6 7
key$$7 :
+$$; <
$str$$= A
+$$B C
property$$D L
.$$L M
value$$M R
+$$S T
Environment$$U `
.$$` a
NewLine$$a h
;$$h i
}%% 
textData'' 
='' 
textData'' '
+''( )
Environment''* 5
.''5 6
NewLine''6 =
;''= >
textData(( 
=(( 
textData(( '
+((( )
$str((* 0
+((1 2
Environment((3 >
.((> ?
NewLine((? F
+((G H
Environment((I T
.((T U
NewLine((U \
;((\ ]
textData)) 
=)) 
textData)) '
+))( )
itemInfo))* 2
.))2 3
item))3 7
.))7 8
id))8 :
+)); <
Environment))= H
.))H I
NewLine))I P
;))P Q
textData** 
=** 
textData** '
+**( )
itemInfo*** 2
.**2 3
item**3 7
.**7 8
name**8 <
+**= >
Environment**? J
.**J K
NewLine**K R
;**R S
textData++ 
=++ 
textData++ '
+++( )
itemInfo++* 2
.++2 3
item++3 7
.++7 8
revision++8 @
+++A B
Environment++C N
.++N O
NewLine++O V
;++V W
textData,, 
=,, 
textData,, '
+,,( )
itemInfo,,* 2
.,,2 3
item,,3 7
.,,7 8
type,,8 <
+,,= >
Environment,,? J
.,,J K
NewLine,,K R
;,,R S
textData-- 
=-- 
textData-- '
+--( )
itemInfo--* 2
.--2 3
item--3 7
.--7 8
type3DX--8 ?
+--@ A
Environment--B M
.--M N
NewLine--N U
;--U V
foreach.. 
(.. 
var..  
property..! )
in..* ,
itemInfo..- 5
...5 6
item..6 :
...: ;

properties..; E
)..E F
{// 
textData00  
=00! "
textData00# +
+00, -
property00. 6
.006 7
key007 :
+00; <
$str00= A
+00B C
property00D L
.00L M
value00M R
+00S T
Environment00U `
.00` a
NewLine00a h
;00h i
}11 
textData33 
=33 
textData33 '
+33( )
Environment33* 5
.335 6
NewLine336 =
;33= >
textData44 
=44 
textData44 '
+44( )
$str44* 4
+445 6
Environment447 B
.44B C
NewLine44C J
+44K L
Environment44M X
.44X Y
NewLine44Y `
;44` a
foreach55 
(55 
var55  
project55! (
in55) +
itemInfo55, 4
.554 5
projects555 =
)55= >
{66 
textData77  
=77! "
textData77# +
+77, -
project77. 5
.775 6
id776 8
+779 :
Environment77; F
.77F G
NewLine77G N
;77N O
textData88  
=88! "
textData88# +
+88, -
project88. 5
.885 6
name886 :
+88; <
Environment88= H
.88H I
NewLine88I P
;88P Q
foreach99 
(99  !
var99! $
property99% -
in99. 0
project991 8
.998 9

properties999 C
)99C D
{:: 
textData;; $
=;;% &
textData;;' /
+;;0 1
property;;2 :
.;;: ;
key;;; >
+;;? @
$str;;A E
+;;F G
property;;H P
.;;P Q
value;;Q V
+;;W X
Environment;;Y d
.;;d e
NewLine;;e l
;;;l m
}<< 
textData==  
===! "
textData==# +
+==, -
Environment==. 9
.==9 :
NewLine==: A
;==A B
}@@ 
textBox1AA 
.AA 
TextAA !
=AA" #
textDataAA$ ,
;AA, -
button2BB 
.BB 
EnabledBB #
=BB$ %
trueBB& *
;BB* +
button3CC 
.CC 
EnabledCC #
=CC$ %
trueCC& *
;CC* +
}DD 
}FF 
elseGG 
{HH 
returnII 
;II 
}JJ 
}LL 	
privateNN 
voidNN 
button2_ClickNN "
(NN" #
objectNN# )
senderNN* 0
,NN0 1
	EventArgsNN2 ;
eNN< =
)NN= >
{OO 	
stringPP 
keyPP 
=PP 
textBox2PP !
.PP! "
TextPP" &
;PP& '
boolQQ 
foundQQ 
=QQ 
falseQQ 
;QQ 
stringRR 
valueRR 
=RR 
$strRR ,
;RR, -
foreachSS 
(SS 
varSS 
propertySS !
inSS" $
itemInfoSS% -
.SS- .
documentSS. 6
.SS6 7

propertiesSS7 A
)SSA B
{TT 
ifUU 
(UU 
propertyUU 
.UU 
keyUU  
==UU! #
keyUU$ '
)UU' (
{VV 
foundWW 
=WW 
trueWW  
;WW  !
valueXX 
=XX 
propertyXX $
.XX$ %
valueXX% *
;XX* +
}YY 
}ZZ 
label7[[ 
.[[ 
Text[[ 
=[[ 
value[[ 
;[[  
}]] 	
private__ 
void__ 
button3_Click__ "
(__" #
object__# )
sender__* 0
,__0 1
	EventArgs__2 ;
e__< =
)__= >
{`` 	
stringaa 
keyaa 
=aa 
textBox3aa !
.aa! "
Textaa" &
;aa& '
boolbb 
foundbb 
=bb 
falsebb 
;bb 
stringcc 
valuecc 
=cc 
$strcc ,
;cc, -
foreachdd 
(dd 
vardd 
propertydd !
indd" $
itemInfodd% -
.dd- .
itemdd. 2
.dd2 3

propertiesdd3 =
)dd= >
{ee 
ifff 
(ff 
propertyff 
.ff 
keyff  
==ff! #
keyff$ '
)ff' (
{gg 
foundhh 
=hh 
truehh  
;hh  !
valueii 
=ii 
propertyii $
.ii$ %
valueii% *
;ii* +
}jj 
}kk 
label8ll 
.ll 
Textll 
=ll 
valuell 
;ll  
}nn 	
}oo 
}qq 